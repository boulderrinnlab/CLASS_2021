---
title: "Global peak properties"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(GenomicRanges)
library(Gviz)
source("/scratch/Shares/rinnclass/tardigrades/CLASS_2021/util/intersect_functions.R")
source("/scratch/Shares/rinnclass/tardigrades/CLASS_2021/util/_setup.R")
```

# metaplots for high binders of promoters vs high binders of promoters AND gene body

## analysis in 08_01 showed that there are two groups, 1) high binders that only bind promoters, 2) that bind to both, promoter and gene body

### this is just a control to see where they bind. If they bind close to promoter but not within -3000 +3000, then they might still be bound to promoter that are larger than defined window. If there are bound 

```{r}
# load important files/ data 
gencode_gr <- rtracklayer::import("/Shares/rinn_class/data/genomes/human/gencode/v32/gencode.v32.annotation.gtf")

data_path <- "/scratch/Shares/rinnclass/tardigrades/CLASS_2021/analysis/"
consensus_peaks <- import_peaks(file.path(data_path, "00_consensus_peaks/results/filtered_consensus"))

```

# define new windows 

```{r}
# use the new promoter and gene body minus promoters peak_occurences to define new windows 

```

# heatmaps

```{r}



```