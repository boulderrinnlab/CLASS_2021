---
title: "Seperating out the mRNA and lncRNA Promoter binding events"
author: "CMT"
date: "03/12/2021"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(GenomicRanges)
source("util/intersect_functions.R")
source("util/plotting_functions.R")
source("util/_setup.R")
library(Gviz)
library(ggpubr)
library(ggplot2)
```

```{r}
#Load in data for promoters
lncrna_mrna_promoters <- rtracklayer::import ("/scratch/Shares/rinnclass/Chelsea/analysis/results/promoter_regions/lncrna_mrna_promoters.gtf")

lncrna_promoters <- rtracklayer::import ("/scratch/Shares/rinnclass/Chelsea/analysis/results/promoter_regions/lncrna_promoters.gtf")

mrna_promoters <- rtracklayer::import ("/scratch/Shares/rinnclass/Chelsea/analysis/results/promoter_regions/mrna_promoters.gtf")
```


```{r}
#load in data for gene_bodies
lncrna_mrna_gene_bodies <- rtracklayer::import ("/scratch/Shares/rinnclass/Chelsea/analysis/results/gene_bodies/lncrna_mrna_genebody.gtf")

lncrna_promoters_gene_bodies <- rtracklayer::import ("/scratch/Shares/rinnclass/Chelsea/analysis/results/gene_bodies/lncrna_genebody.gtf")

mrna_promoters_gene_bodies <- rtracklayer::import ("/scratch/Shares/rinnclass/Chelsea/analysis/results/gene_bodies/mrna_genebody.gtf")
```


```{r}
#peak_occurence for both mRNA and lncRNA
peak_occurence <- read_csv("/scratch/Shares/rinnclass/Chelsea/analysis/results/peak_occurence_dataframe.csv")

#test <- read_table("/scratch/Shares/rinnclass/Chelsea/analysis/results/lncrna_mrna_promoter_peak_occurence_matrix.tsv")
```


```{r}
#Filter peak_occurence to separate mRNA and lnRNA
peak_occurence_lncRNA <- filter(peak_occurence, gene_type == "lncRNA")

#plot individual plot of peak_occurence_lnRNA
g <- ggplot(peak_occurence_lncRNA, aes(x = number_of_dbp))

g + geom_density(alpha = 0.2, color = "#424242", fill = "#424242") +
  theme_paperwhite() +
  xlab(expression("Number of DBPs")) +
  ylab(expression("Density")) +
  ggtitle("Promoter binding events",
          subtitle = "lncRNA genes") 

```

```{r}
#Filter peak_occurence to separate mRNA and lnRNA
peak_occurence_mRNA <- filter(peak_occurence, gene_type == "protein_coding")

#plot individual plot of peak_occurence_mRNA
g <- ggplot(peak_occurence_mRNA, aes(x = number_of_dbp))

g + geom_density(alpha = 0.2, color = "#424242", fill = "#424242") +
  theme_paperwhite() +
  xlab(expression("Number of DBPs")) +
  ylab(expression("Density")) +
  ggtitle("Promoter binding events",
          subtitle = "mRNA genes") 

```

```{r}
#plot both the lncRNA and protein_coding Promoter binding events
g <- ggplot(peak_occurence, aes(x = number_of_dbp, fill = gene_type, color = gene_type))

g + geom_density(alpha = 0.0) +
theme_paperwhite() +
  xlab(expression("Number of DBPs")) +
  ylab(expression("Density")) +
  ggtitle("Promoter binding events",
          subtitle = "mRNA and lncRNA genes")
```
